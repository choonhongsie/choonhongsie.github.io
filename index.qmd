---
sidebar: true
format:
  html:
    grid: 
      sidebar-width: 300px
      body-width: 1500px
      margin-width: 50px
      gutter-width: 0rem
---

```{=html}
<section class="image-container">
  <img src="src/images/Food Waste Background image.jpg" style="width:100%;height:300px;object-fit:cover;"/>
  <h5 class="center-text-bg-img">What are the key drivers of food waste in Singapore and around the world?</h5>
<p class="bottom-right-text-bg-img">Image by <a style="text-decoration:underline;color:white;" href="https://www.freepik.com/free-photo/close-up-hand-holding-wooden-board_14351726.htm#query=food%20waste&position=26&from_view=search&track=ais" target="_blank" style="color:white; text-decoration: none;">Freepik</a></p>
</section>

<section id="introduction" class="container" width="100%">
<h4 class="text-center fw-bold my-4">Introduction</h4>
<p>Food waste is a major global problem (UNEP, 2022). According to the United Nations, it is estimated that one-third of the food produced for human consumption is lost or wasted on a global scale, totaling around 1.3 billion tons annually (FAO, 2011).
</p>

<h4 id="whatIsFW" class="text-center fw-bold my-4">What is <div class="foodwasteword">Food Waste?<div></h4>
<p>According to the <strong>United Nations' Food and Agricultural Organisation (FAO)</strong>,"food waste" refers to the discarding or non-food use of products that are safe and nutritious for human consumption</p>
```
```{r import libraries, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(plotly)
library("ggchicklet")
library(scales)
library(highcharter)
library(gganimate)
library(ggthemes)
library(gifski)

FWD_sg <- read_csv("src/data/Food Waste Statistics.csv")
FWD_UNEP <- read_csv("src/data/UNEP Food Waste Statistics.csv")
WasteStats_SG <- read_csv("src/data/Waste Stats Singapore.csv")

remove_background_theme <- function() {
    theme(
      panel.background = element_blank(),
      panel.grid.major = element_blank(),
      axis.ticks = element_blank()
    )
}
```

```{r Data Manipulation, echo=FALSE, message=FALSE, warning=FALSE}
# FWD_UNEP
#Create new column for combined estimate in tonnes/year
FWD_UNEP <- mutate(FWD_UNEP, combined_estimate_tonnes_per_year = FWD_UNEP$`Household estimate (tonnes/year)` + FWD_UNEP$`Retail estimate (tonnes/year)` + FWD_UNEP$`Food service estimate (tonnes/year)`)

FWD_UNEP <- FWD_UNEP[, c(1,2,13,3,4,5,6,7,8,9,10,11,12)]

# Changing column names to make them lowercase and include underscores for easier reference
new_col_names <- c("country", "combined_estimate_kpcpy", "combined_estimate_tpy", "household_estimate_kpcpy", "household_estimate_tpy", "retail_estimate_kpcpy", "retail_estimate_tpy", "food_service_estimate_kpcpy", "food_service_estimate_tpy", "estimate_confidence", "m49_code", "region", "source")
names(FWD_UNEP) <- new_col_names

# Get source column 
dataSources <- FWD_UNEP %>% select(country, m49_code, source)

# Remove source column 
FWD_UNEP <- FWD_UNEP[, -13]

# Find total global food waste in 2021
total_foodwaste_2021 <- sum(FWD_UNEP$combined_estimate_tpy)
  
total_foodwaste_2021 <- format(total_foodwaste_2021, big.mark = ",", scientific = FALSE) 
dataT <- FWD_UNEP

# Subset the dataframe to select the top 10 countries with the highest and lowest combined per-capita food waste
# order() sort the data in ascending order from the lowest index 
topCountries <- tail(FWD_UNEP[order(FWD_UNEP$combined_estimate_kpcpy), ], 10)
bottomCountries <- head(FWD_UNEP[order(FWD_UNEP$combined_estimate_kpcpy), ], 10)

# Top 5 countries including Singapore of household estimate tonnes per year
top_5_countries <- FWD_UNEP %>% select(country, household_estimate_tpy) %>% arrange(desc(household_estimate_tpy)) %>% slice(1:5)
additional_row <- FWD_UNEP %>% filter(country == "Singapore") %>% select(country, household_estimate_tpy)

combined <- bind_rows(top_5_countries, additional_row)

# Group the data by the 'region' column
FWD_UNEP_region <- FWD_UNEP %>% group_by(region)
total_FW_region <- FWD_UNEP_region %>% 
  summarize(total_combined_estimate_kpcpy = sum(combined_estimate_kpcpy),
            total_household_estimate_kpcpy = sum(household_estimate_kpcpy),
            total_retail_estimate_kpcpy = sum(retail_estimate_kpcpy),
            total_food_service_estimate_kpcpy = sum(food_service_estimate_kpcpy)) 

# Calculate averages for each per-capita food waste column
avg_FW_region <- FWD_UNEP_region %>%
  summarize(
    avg_combined_kpcpy = mean(combined_estimate_kpcpy, na.rm = TRUE),
    avg_household_kpcpy = mean(household_estimate_kpcpy, na.rm = TRUE),
    avg_retail_kpcpy = mean(retail_estimate_kpcpy, na.rm = TRUE),
    avg_food_service_kpcpy = mean(food_service_estimate_kpcpy, na.rm = TRUE))

total_household <- sum(FWD_UNEP$household_estimate_tpy)
total_retail <- sum(FWD_UNEP$retail_estimate_tpy)
total_food_service <- sum(FWD_UNEP$food_service_estimate_tpy)

# Create a data frame
total_FW_by_sector <- data.frame(
  category = c("Household", "Retail", "Food Service"),
  value = c(total_household, total_retail, total_food_service),
  color = c("#d62023", "#3fb619", "#8FB8FDff")
)
# avg_FW_region
# Order the data by combined averages
avg_FW_region <- avg_FW_region[order(avg_FW_region$avg_combined_kpcpy, decreasing = TRUE), ]

# FWD_sg
# Rename Column Names
new_col_names_sg <- c("year", "disposed_tonnes", "recycled_tonnes", "generated_tonnes", "recycling_rate_percent")
names(FWD_sg) <- new_col_names_sg

# WasteStats_SG
# Rename Column Names
new_col_names_waste_sg <- c("waste_type", "generated_tonnes", "recycled_tonnes", "recycling_rate_percent", "disposed_tonnes")
names(WasteStats_SG) <- new_col_names_waste_sg
WasteStats_SG <- WasteStats_SG %>% filter(waste_type != "Overall")
```

```{=html}
<h4 id="totalFWbyRegion" class="text-center fw-bold my-4">Do you know that household accounts for most of the food waste?</h4>
<section class="container" style="width:100%;">
  <section class="row">
    <section class="col-lg-8">
      <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Pie Chart</button>
          <button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Bar Chart</button>
        </div>
      </nav>
      <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
  
```
```{r Total Food Waste by sector Pie Chart in the World, echo=FALSE, message=FALSE, warning=FALSE}
# Create a pie chart using highcharter
highchart() %>%
  hc_chart(type = "pie") %>%
  hc_add_series(total_FW_by_sector, "pie", hcaes(y = "value", name = "category", color = "color")) %>% 
  hc_tooltip(
    pointFormat = "<b>{point.name}</b>: {point.y} tonnes/year ({point.percentage:.1f}%)"
  ) %>%  hc_plotOptions(
    pie = list(
      dataLabels = list(
        enabled = TRUE,
        format = "{point.percentage:.1f}%",
        style = list(fontWeight = "bold")
      ), 
      showInLegend = TRUE
    )
  ) %>% 
  hc_title(text = "Total Food Waste by Sector in the World") %>%
  hc_legend(enabled = TRUE) %>%
  hc_subtitle(text = "Total Food Waste (Tonnes/Year)") 
```

```{=html}
        </div>
      <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
```
```{r Total Food Waste by sector in the World Bar Chart, echo=FALSE, message=FALSE, warning=FALSE}
ggplot() +
  geom_chicklet(radius = grid::unit(2, 'mm'),
                aes(x = c("Household", "Retail", "Food Service"),
        y = c(as.numeric(total_household),
              as.numeric(total_retail),
              as.numeric(total_food_service)),
        fill = c("#d62023", "#3fb619", "#8FB8FDff"))) +
  geom_text(
    aes(
       x = c("Household", "Retail", "Food Service"),
      y = c(as.numeric(total_household),
        as.numeric(total_retail),
        as.numeric(total_food_service)),
      hjust = 0.5, vjust = 2, fontface = "bold",
      label = scales::comma(c(as.numeric(total_household),
          as.numeric(total_retail),
          as.numeric(total_food_service)))), colour = "white"
  ) +
  labs(
    title = "Total Food Waste by Sector in the World",
    x = "",
    y = "Total Food Waste (Tonnes/Year)"
  ) +
  scale_fill_manual(
    values = c("#3fb619" = "#3fb619", "#d62023" = "#d62023", "#8FB8FDff" = "#8FB8FDff"),
    name = "Food Waste Sector",
    breaks = c("#3fb619", "#d62023", "#8FB8FDff"),
    labels = c("Retail", "Household", "Food Service")
  ) +
  remove_background_theme() +
  theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"))
```

```{=html}
    </div>
  </div>
</section>  
<section class="col-lg-4 mt-4">
  <p>The chart shows that households are the largest contributors to food waste, accounting for 61.1% of the total. This is followed by food services (26.2%) and retail establishments (12.7%).</p>
  </section>
<h4 id="worldMap" class="text-center fw-bold my-4">Which Country Generated the most Household Food Waste?</h4>
<h4 class="text-center fw-bold my-4">Let's see it from the World Map <i class="bi bi-map-fill"></i></h4>
```
```{r World Map Household,echo=FALSE, warning=FALSE, message=FALSE}
data(worldgeojson, package = "highcharter")

countries <- FWD_UNEP %>% select(country, household_estimate_tpy)

highchart() %>% hc_title(text = "Household Food Waste by Countries (tonnes/year)") %>%
hc_add_series_map(worldgeojson, countries, value = "household_estimate_tpy", joinBy = c("name", "country")) %>% 
  hc_colorAxis(minColor = "white", maxColor = "#d62023") %>%
hc_legend(valueDecimals = 0, valueSuffix = "%") %>% 
hc_mapNavigation(enabled = TRUE)
```

```{=html}
<p>At first glance, we can see that China, followed by India, has generated the most household food waste. This is not surprising as they are the most populous countries in the world.</p>
<h4 id="closerLook" class="text-center fw-bold my-4">Let's take a closer look...</h4>
<section class="container" style="width:100%;">
<section class="row">
<section class="col-lg-8">
```
```{r 5 Countries with Highest Household Food Waste, echo=FALSE, warning=FALSE}
ggplot(combined, aes(reorder(country, household_estimate_tpy), household_estimate_tpy)) + 
  geom_chicklet(radius = grid::unit(2, 'mm'), fill = "#d62023") + 
  coord_flip(clip = "off") + 
  geom_text(aes(label = format(household_estimate_tpy, big.mark = ",", scientific = FALSE)), hjust = -0.2) + 
  theme(axis.text.x = element_blank(),
        plot.margin = margin(r = 120)) + 
  remove_background_theme() +
  labs(title = "The 5 Countries with Highest Household Food Waste",
         x = "" , y = "Household Food Waste (tonnes/year)", caption = "Source: Kaggle - Household Food Waste Estimate of all Countries") 
```

```{=html}
</section>
<section class="col-lg-4">

<p>China and India, the two most populous countries in the world, also produce the most household food waste. In 2021, China produced an estimated 92 million metric tons of household food waste, while India produced 69 million metric tons. This accounts for nearly one-third of the world's total household food waste.</p>

</section>
</section>

<h4 id="top10-bottom10" class="text-center fw-bold my-4">What are the Top 10 and Bottom 10 Countries for Combined per-capita Food Waste?</h4>
</section> <!-- hello -->

<section class="container" style="width:100%;">
<section class="row">
<section class="col-lg-8">
  <nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
      <button class="nav-link active" id="nav-top10-tab" data-bs-toggle="tab" data-bs-target="#nav-top10" type="button" role="tab" aria-controls="nav-top10" aria-selected="true">Top 10 Countries</button>
      <button class="nav-link" id="nav-bottom10-tab" data-bs-toggle="tab" data-bs-target="#nav-bottom10" type="button" role="tab" aria-controls="nav-bottom10" aria-selected="true">Bottom 10 Countries</button>
      <button class="nav-link" id="nav-region-tab" data-bs-toggle="tab" data-bs-target="#nav-region" type="button" role="tab" aria-controls="nav-region" aria-selected="false">Bar Chart by Region
      </button>
    </div>
  </nav>
  <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-top10" role="tabpanel" aria-labelledby="nav-top10-tab">
```
```{r Top 10 Countries, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(topCountries, aes(x = reorder(country, combined_estimate_kpcpy), y = combined_estimate_kpcpy)) +
  geom_chicklet(radius = grid::unit(2, 'mm'), fill = "#d62023") +
  # geom_bar(stat = "identity", fill = "red", width = 0.7) +
  geom_text(aes(label = combined_estimate_kpcpy), hjust = 1.8, vjust = 0.5, size = 3, colour = "white", fontface = "bold") +  
  labs(title = str_wrap("The 10 Countries with Highest Combined Per-Capita Food Waste",width = 40),
       subtitle = "Per-Capita Food Waste (kg/year)",
    x = "", y = "Per-Capita Food Waste (kg/year)") +
  remove_background_theme() +
  coord_flip() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold",margin = margin(b = 20, l= 20, r = 20)), plot.subtitle = element_text(hjust = 0.5, size = 14)) 
```

```{=html}
</div>
    <div class="tab-pane fade" id="nav-bottom10" role="tabpanel" aria-labelledby="nav-bottom10-tab">
```
```{r Bottom 10 Countries, echo=FALSE, message=FALSE, warning=FALSE}
# Show the 10 countries with the lowest combined per-capita food waste
ggplot(bottomCountries, aes(x = reorder(country, combined_estimate_kpcpy), y = combined_estimate_kpcpy)) +
  geom_chicklet(radius = grid::unit(2, 'mm'), fill = "#3fb619") +
  geom_text(aes(label = combined_estimate_kpcpy), hjust = 1.8, vjust = 0.5, size = 3, colour = "white", fontface = "bold") +
  labs(title = str_wrap("The 10 Countries with Lowest Combined Per-Capita Food Waste", width = 40),
    x = "", y = "Per-Capita Food Waste (kg/year)") +
  remove_background_theme() +
  coord_flip() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold",margin = margin(b = 20, l= 20, r = 20)))
```

```{=html}
    </div>
    <div class="tab-pane fade" id="nav-region" role="tabpanel" aria-labelledby="nav-region-tab">
```
```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Show how different categories of per-capita food waste compare in each region
total_FW_region <- ggplot(total_FW_region, aes(y = reorder(region, total_combined_estimate_kpcpy), x = total_combined_estimate_kpcpy, fill = "Combined")) +
  geom_col(aes(x = total_household_estimate_kpcpy, fill = "Household", 
               text = paste0("Household: ", total_household_estimate_kpcpy, "kg")), width = 0.7) +
  geom_col(aes(x = total_food_service_estimate_kpcpy, fill = "Food Service", 
               text = paste0("Food Service: ", total_food_service_estimate_kpcpy, "kg")), width = 0.7) +
  geom_col(aes(x = total_retail_estimate_kpcpy, fill = "Retail", 
               text = paste0("Retail: ", total_retail_estimate_kpcpy, "kg")), width = 0.7) +
  labs(title = str_wrap("Total Food Waste Sector by Region", width = 35),
    y = "",
    x = "Total Per-Capita Food Waste (kg/year)") +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(
    values = c("Household" = "#d62023", "Retail" = "#3fb619", "Food Service" = "#8FB8FDff"),
    name = "Food Waste Types",
    labels = c("Retail", "Household", "Food Service")) +
  guides(fill = guide_legend(title = "Food Waste Sector")) +
  theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"), axis.text.x = element_text(angle = 0, hjust = 1), legend.position = "bottom",plot.margin = margin(t = 15)) +
  remove_background_theme()

ggplotly(total_FW_region,tooltip = "text") %>%
  config(displayModeBar = FALSE) %>%
layout(legend = list(orientation = "h", x = -0.2, y = -0.2))
```

```{=html}
  </div>
  </div>
</section>
<section class="col-lg-4">
  <h6><strong>Top 10 Countries</strong></h6>
<p>The majority of the top 10 countries are situated in Sub-Saharan Africa (or Africa) and the Western Asia (or Middle East), regions known for their comparatively lower levels of socioeconomic development. According to International Monetary Fund (IMF) (2021), Sub-Saharan Africa was projected experience the slowest economic growth compared to other region in the world in 2021. Additionally, Sub-Saharan Africa and Western Asia's Gross Domestic Product (GDP) per capita figures  of approximately <strong>USD$1626.28</strong> and <strong>USD$6266.36</strong>, respectively, among the lowest in the world(O'Neill, 2023).</p>

<h6><strong>Bottom 10 Countries</strong></h6>
<p>The majority of the bottom 10 countries are exhibiting the lowest food waste per capita are situated in Western Europe, which is renowned as a highly developed region globally.</p>
</section>
</section> 
</section>
```
```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Show how different categories of per-capita food waste compare in each region
avg_FW_region <- ggplot(avg_FW_region, aes(y = reorder(region, avg_combined_kpcpy), x = avg_combined_kpcpy, fill = "Combined")) +
  geom_col(aes(x = avg_household_kpcpy, fill = "Household", 
               text = paste0("Household: ", avg_household_kpcpy, "kg")), width = 0.7) +
  geom_col(aes(x = avg_food_service_kpcpy, fill = "Food Service", 
               text = paste0("Food Service: ", avg_food_service_kpcpy, "kg")), width = 0.7) +
  geom_col(aes(x = avg_retail_kpcpy, fill = "Retail", 
               text = paste0("Retail: ", avg_retail_kpcpy, "kg")), width = 0.7) +
  labs(title = str_wrap("Relative Proportions of Food Waste Sector by Region", width=30),
    y = "",
    x = "Average Per-Capita Food Waste (kg/year)")+
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
  scale_fill_manual(
    values = c("Household" = "#d62023", "Retail" = "#3fb619", "Food Service" = "#8FB8FDff"),
    name = "Food Waste Types",
    labels = c("Retail", "Household", "Food Service")
  ) +
  guides(fill = guide_legend(title = "Food Waste Sector")) +
  remove_background_theme() +
  theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"), 
        legend.position = "bottom", plot.margin = margin(t = 15))

ggplotly(avg_FW_region,tooltip = "text") %>%
  config(displayModeBar = FALSE)%>%
layout(aspectratio = list(x = 1, y = 1),legend = list(orientation = "h", x = -0.2, y = -0.2))
  # annotations = list(
  #     text = "Average Per-Capita Food Waste (kg/year)",  # Subtitle text
  #     showarrow = FALSE,
  #     x = 0,
  #     y = 17.6,
  #     font = list(size = 14)
  #   )
  # )

# will be useful if change the position of the legend
# %>%
#   layout(aspectratio = list(x = 1, y = 1),legend = list(orientation = "h", x = 0, y = 1.1), margin= margin(t=5, b=5))
```

```{=html}
</section>
</section>
</section>

<section id="FW_SG"class="image-container">
  <img src="src/images/Singapore Food Waste Background.png" style="width:100%;height:300px;object-fit:cover;"/>
  
  <h5 class="center-text-bg-img">Food Waste in Singapore</h5>
<p class="bottom-right-text-bg-img">Image by <a style="text-decoration:underline;color:white;" href="https://static.mothership.sg/1/2019/12/nea-survey-food-waste.png" target="_blank" style="color:white; text-decoration: none;">Freepik</a></p>
</section>

<section id="singapore" class="container my-5" width="100%">
<p>Food waste is a serious problem in Singapore, as it affects food security and puts pressure on resources. This is especially concerning given that Singapore imports over 90% of its food supply and is a land-scarce country (Towards Zero Waste, n.d.).</p>
```
```{r, echo=FALSE, warning=FALSE, message=FALSE}
FWD_sg <- FWD_sg %>% pivot_longer(cols = disposed_tonnes:disposed_tonnes:recycled_tonnes:generated_tonnes,
              names_to = "Sector",
              values_to = "Tonnes") %>% 
          mutate(Sector = case_when(
            Sector == "disposed_tonnes" ~ "Disposed",
            Sector == "generated_tonnes" ~ "Generated",
            Sector == "recycled_tonnes" ~ "Recycled",
            TRUE ~ as.character(Sector)
          ))

# FWD_sg_line <- ggplot(FWD_sg, aes(x = year)) +
#   geom_line(aes(y = Value, group = Type, color = Type)) +
#   geom_point(aes(y = Value, color = Type)) +
#   ylim(c(0, 1000000)) +
#   labs(x = "Year",y ="") +
#   theme(axis.text.x = element_text(angle = 90, size = 8)) +
#   remove_background_theme() +
#   theme(panel.grid.major = element_line(color = "lightgrey", size = 0.5)) +
#   scale_x_continuous(breaks = seq(2003, 2022, by = 1)) +
#   scale_color_manual(values = c("grey", "brown", "#3fb619"))
# 
# 
# ggplotly(FWD_sg_line,tooltip = c("x", "y")) %>%
#    config(displayModeBar = FALSE) %>%
#   layout(dragmode = FALSE,legend = list(orientation = "h", x = -0.2, y = -0.2))

# Rename observation rows in the "Sector" column
  

# Spline Plot
FWD_sg %>% 
  hchart('spline', hcaes(x = 'year', y = 'Tonnes', group = "Sector")) %>% 
  hc_title(text = "Waste Statistics and Overall Recycling Table in Singapore")
```

```{=html}
<p>According to the National Environment Agency (NEA) (n.d.), Singapore generated <strong>763,000 tonnes</strong> of food waste in 2022 and this accounted for 11% of total waste. This amount has increased steadily over the years, and it is expected to continue to grow as the population and economy expand.</p>
```
```{r WasteStats_SG, echo=FALSE, warning=FALSE, message=FALSE}
first_5_rows <- head(WasteStats_SG, 5) %>% select(waste_type, generated_tonnes)

grouped_sum <- WasteStats_SG %>%
  slice(6:14) %>%
    summarise(waste_type = "Others", generated_tonnes = sum(generated_tonnes))

final_result <- bind_rows(first_5_rows, grouped_sum)

highchart() %>%
  hc_chart(type = "pie") %>%
  hc_add_series(final_result, "pie", hcaes(y = "generated_tonnes", name = "waste_type", color = "waste_type"), center = c(50, 50), 
                innerSize="50%") %>% 
  hc_tooltip(
    pointFormat = "<b>{point.name}</b>: {point.y} tonnes/year ({point.percentage:.1f}%)"
  ) %>%  hc_plotOptions(
    pie = list(
      dataLabels = list(
        enabled = TRUE,
        format = "<b>{point.name}</b>:<br>({point.percentage:.1f}%)",
        style = list(fontSize = "10px", fontWeight = "bold")
      )
    ),
    showInLegend = TRUE
    ) %>% 
  hc_title(text = "Total Generated Waste by Type in Singapore") %>%
  hc_legend(enabled = TRUE) %>%
  hc_subtitle(text = "Total Food Waste (Tonnes/Year)") 
```

```{=html}
<p><strong>Food waste ranks among the top 3 type of waste generated in Singapore</strong>, trailing behind paper/cardboard and plastic waste. Both Ferrous metal and paper/cardboard have a recycling rate of 99%. The "Others"" types is the combimnation waste type that accounts for <strong>less than 6% of the total waste.</strong></p>
```
```{r FWD_sg, echo=FALSE, warning=FALSE, message=FALSE}
FWD_sg_by_type <- FWD_UNEP %>% filter(country == "Singapore") %>% select(household_estimate_tpy, retail_estimate_tpy, food_service_estimate_tpy) 

FWD_sg_by_type <- FWD_sg_by_type %>% pivot_longer(cols = household_estimate_tpy:retail_estimate_tpy:food_service_estimate_tpy,
                names_to = "Sector",
                values_to = "Value") %>% 
mutate(FWD_sg_by_type, color = c("#d62023", "#3fb619", "#8FB8FDff")) %>% 
# Rename observation rows in the "Sector" column
  mutate(Sector = case_when(
    Sector == "household_estimate_tpy" ~ "Household",
    Sector == "retail_estimate_tpy" ~ "Retail",
    Sector == "food_service_estimate_tpy" ~ "Food Service",
    TRUE ~ as.character(Sector)
  ))

#   # Compute percentages
#   
#   FWD_doughnut$fraction = FWD_doughnut$Value / sum(FWD_doughnut$Value)
# 
#   # Compute the cumulative percentages (top of each rectangle)
#   FWD_doughnut$ymax = cumsum(FWD_doughnut$fraction)
# 
#   # Compute the bottom of each rectangle
#   FWD_doughnut$ymin = c(0, head(FWD_doughnut$ymax, n=-1))
# 
#   # Compute label position
#   FWD_doughnut$labelPosition <- (FWD_doughnut$ymax + FWD_doughnut$ymin) / 2
# 
# ggplot(FWD_doughnut, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Type)) +
#        geom_rect() +
#        geom_text(x=3.5, aes(y=labelPosition, label=FWD_doughnut$Value), color = "white", fontface = "bold", size = 5) +
#        coord_polar(theta="y") +
#        xlim(c(2, 4)) +
#         theme_void() +
#     scale_fill_manual(
#       values = c("#3fb619","#d62023", "#8FB8FDff"),
#       name = "Food Waste Types",
#       labels = c("Retail", "Household", "Food Service")
# )
# 

highchart() %>%
  hc_chart(type = "pie") %>%
  hc_add_series(FWD_sg_by_type, "pie", hcaes(y = "Value", name = "Sector", color = "color"), center = c(50, 50), 
                innerSize="50%") %>% 
  hc_tooltip(
    pointFormat = "<b>{point.name}</b>: {point.y} tonnes/year ({point.percentage:.1f}%)"
  ) %>%  hc_plotOptions(
    pie = list(
      dataLabels = list(
        enabled = TRUE,
        format = "<b>{point.name}</b>:<br>({point.percentage:.1f}%)",
        style = list(fontSize = "10px", fontWeight = "bold")
      )
    )
    ) %>% 
  hc_title(text = "Total Food Waste by Sector in Singapore") %>%
  hc_legend(enabled = TRUE) %>%
  hc_subtitle(text = "Total Food Waste (Tonnes/Year)") 

```

```{=html}
<section id="references" class="container mt-5" style="width:100%;">
  
<div class="accordion" id="accordionExample">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingOne">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="f" aria-controls="collapseOne">
        <h4>References</h4>
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <p>Miquelis, P. (2019, january 25). The Truth About Food Waste in Singapore (and beyond). <a href="https://greenisthenewblack.com/the-truth-about-food-waste-in-singapore-and-beyond/" target="_blank">https://greenisthenewblack.com/the-truth-about-food-waste-in-singapore-and-beyond/</a></p> 
        
<p>United Nation Environment Programme. (2022, September 26). Why the global fight to tackle food waste has only just begun. <a href="https://www.unep.org/news-and-stories/story/why-global-fight-tackle-food-waste-has-only-just-begun" target="_blank">https://www.unep.org/news-and-stories/story/why-global-fight-tackle-food-waste-has-only-just-begun</a></p>

<p>https://worldpopulationreview.com/country-rankings/food-waste-by-country</p>

<p>Lee, H.W. (2022, January 3).Food Wastage Statistics in Singapore. <a href="https://www.bestinsingapore.co/food-wastage-statistics-singapore/" target="_blank">https://www.bestinsingapore.co/food-wastage-statistics-singapore/</a></p>

<p>Food and Agriculture Organization. (n.d.). The State of Food and Agriculture - 2019. <a href="https://www.fao.org/state-of-food-agriculture/2019/en/" target="_blank">https://www.fao.org/state-of-food-agriculture/2019/en/</a></p>

<p>Low, Y.J. (2019, August 6). Every Singaporean household throws away an average S$258 worth of food a year: Study. <a href="https://www.todayonline.com/singapore/every-singaporean-household-throws-away-average-s258-worth-food-year-study" target="_blank">https://www.todayonline.com/singapore/every-singaporean-household-throws-away-average-s258-worth-food-year-study</a></p>

<p>https://blogs.ntu.edu.sg/hp3203-2021s1-u21/whatisfoodwastage/in-singapore/</p>

<p>Food and Agriculture Organization of the United Nations (FAO). 2011. Global food losses and food waste â€“ Extent, causes and prevention. Rome. <a href="https://www.fao.org/3/mb060e/mb060e00.htm" target="_blank">https://www.fao.org/3/mb060e/mb060e00.htm</a></p>

<p>National Environment Agency (NEA). (n.d.). Waste Statistics and Overall Recycling
.<a href="https://www.nea.gov.sg/our-services/waste-management/waste-statistics-and-overall-recycling" target="_blank">https://www.nea.gov.sg/our-services/waste-management/waste-statistics-and-overall-recycling</a></p>

<p>Towards Zero Waste. (n.d.). Food Waste. <a href="https://www.towardszerowaste.gov.sg/foodwaste/">https://www.towardszerowaste.gov.sg/foodwaste/</a></p>

<p>Selassie, A. A., & Hakobyan, S. (2021, April 15). Six charts show the challenges faced by Sub-Saharan Africa. International Monetary Fund (IMF). <a href="https://www.imf.org/en/News/Articles/2021/04/12/na041521-six-charts-show-the-challenges-faced-by-sub-saharan-africa">https://www.imf.org/en/News/Articles/2021/04/12/</a></p>

<p>O'Neill, A. (2023, February 2).Gross domestic product (GDP) per capita in selected global regions at current prices in 2021. <a href="https://www.statista.com/statistics/256413/gross-domestic-product-per-capita-in-selected-global-regions/">https://www.statista.com/statistics/256413/gross-domestic-product-per-capita-in-selected-global-regions/</a></p>
      </div>
    </div>
  </div>
  </div>
</section> <!-- End of References Section -->
</section>
</div>
</section>
</section>
</section>
```
